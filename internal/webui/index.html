<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Retrog Web 管理</title>
  <link rel="stylesheet" href="/static/styles.css">
</head>

<body>
  <div id="app">
    <aside class="collections-panel">
      <div class="panel-header with-action">
        <div>
          <h1 class="collection-title">
            <span class="collection-title-text">合集</span>
            <span id="collection-total-count" class="collection-total-count"></span>
          </h1>
          <p class="panel-subtitle">点击左侧合集查看游戏</p>
        </div>
        <div class="panel-actions">
          <button type="button" id="edit-collection" class="ghost">编辑</button>
        </div>
      </div>
      <div class="collection-search">
        <input id="collection-search-input" type="text" placeholder="搜索合集名称或目录" aria-label="搜索合集" />
      </div>
      <ul id="collection-list" class="list"></ul>
      <div id="collection-empty" class="empty-state">未在目录中找到 metadata.pegasus.txt</div>
    </aside>
    <main class="content">
      <form class="search-bar" id="search-form">
        <select id="search-collection" aria-label="选择合集">
          <option value="">全部合集</option>
        </select>
        <input id="search-input" type="text" placeholder="搜索 游戏名 / 游戏详情 / ROM名" aria-label="搜索内容" />
        <button type="button" id="search-clear">清空</button>
      </form>
      <div class="panels">
        <section class="games-panel">
          <div class="panel-header with-action">
            <div>
              <h2>游戏</h2>
              <p class="panel-subtitle">name (rom 路径)</p>
            </div>
            <div class="panel-actions">
              <button type="button" id="toggle-missing-games" class="ghost">显示缺失</button>
              <button type="button" id="add-game" class="ghost">新增</button>
            </div>
          </div>
          <ul id="game-list" class="list"></ul>
          <div id="game-empty" class="empty-state">请选择左侧的合集</div>
        </section>
        <section class="details-panel">
          <div class="panel-header with-action">
            <div>
              <h2>元信息</h2>
              <p class="panel-subtitle">展示 metadata 中的所有字段</p>
            </div>
            <div class="panel-actions">
              <button type="button" id="show-rom-info" class="ghost">Rom信息</button>
              <button type="button" id="edit-game" class="ghost">编辑</button>
              <button type="button" id="delete-game" class="ghost danger">删除</button>
            </div>
          </div>
          <div id="field-list" class="fields"></div>
          <div id="field-empty" class="empty-state">请选择游戏查看字段</div>
        </section>
        <section class="media-panel">
          <div class="panel-header">
            <h2>媒体</h2>
            <p class="panel-subtitle">自动预览图片/视频资源</p>
          </div>
          <div id="media-list" class="media-grid"></div>
          <div id="media-empty" class="empty-state">暂无媒体文件</div>
        </section>
      </div>
    </main>
  </div>
  <div id="edit-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3>编辑游戏元信息</h3>
        <button type="button" id="edit-close">×</button>
      </div>
      <form id="edit-form" class="edit-form">
        <div id="edit-fields" class="edit-fields"></div>
        <div class="edit-actions">
          <div class="left">
            <button type="button" id="edit-add-field">新增字段</button>
          </div>
          <div class="right">
            <button type="button" id="edit-cancel">取消</button>
            <button type="submit">保存</button>
          </div>
        </div>
      </form>
      <div id="edit-status" class="edit-status"></div>
    </div>
  </div>
  <div id="collection-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3>编辑合集元信息</h3>
        <button type="button" id="collection-close">×</button>
      </div>
      <form id="collection-form" class="edit-form collection-form">
        <div class="collection-fields">
          <div class="collection-field-row">
            <label for="collection-x-index-id" class="collection-field-key">x-index-id</label>
            <div class="collection-field-value">
              <input id="collection-x-index-id" type="text" readonly />
            </div>
          </div>
          <div class="collection-field-row">
            <label for="collection-name" class="collection-field-key">name</label>
            <div class="collection-field-value">
              <input id="collection-name" type="text" placeholder="合集名称" />
            </div>
          </div>
          <div class="collection-field-row">
            <label for="collection-sortby" class="collection-field-key">sort-by</label>
            <div class="collection-field-value">
              <input id="collection-sortby" type="text" placeholder="排序值" />
            </div>
          </div>
          <div class="collection-field-row">
            <label for="collection-extension" class="collection-field-key">extension</label>
            <div class="collection-field-value">
              <textarea id="collection-extension" placeholder="每行一个扩展名"></textarea>
            </div>
          </div>
          <div class="collection-field-row">
            <label for="collection-ignore-extension" class="collection-field-key">ignore-extension</label>
            <div class="collection-field-value">
              <textarea id="collection-ignore-extension" placeholder="每行一个扩展名"></textarea>
            </div>
          </div>
          <div class="collection-field-row">
            <label for="collection-ignore-file" class="collection-field-key">ignore-file</label>
            <div class="collection-field-value">
              <textarea id="collection-ignore-file" placeholder="每行一个文件"></textarea>
            </div>
          </div>
          <div class="collection-field-row">
            <label for="collection-file" class="collection-field-key">file</label>
            <div class="collection-field-value">
              <textarea id="collection-file" placeholder="每行一个文件"></textarea>
            </div>
          </div>
          <div class="collection-field-row">
            <label for="collection-regex" class="collection-field-key">regex</label>
            <div class="collection-field-value">
              <textarea id="collection-regex" placeholder="每行一个正则"></textarea>
            </div>
          </div>
          <div class="collection-field-row">
            <label for="collection-short-name" class="collection-field-key">shortname</label>
            <div class="collection-field-value">
              <input id="collection-short-name" type="text" placeholder="短名称" />
            </div>
          </div>
          <div class="collection-field-row">
            <label for="collection-summary" class="collection-field-key">summary</label>
            <div class="collection-field-value">
              <textarea id="collection-summary" placeholder="摘要"></textarea>
            </div>
          </div>
          <div class="collection-field-row">
            <label for="collection-description" class="collection-field-key">description</label>
            <div class="collection-field-value">
              <textarea id="collection-description" class="tall" placeholder="描述"></textarea>
            </div>
          </div>
          <div class="collection-field-row">
            <label for="collection-cwd" class="collection-field-key">cwd</label>
            <div class="collection-field-value">
              <input id="collection-cwd" type="text" placeholder="工作目录" />
            </div>
          </div>
          <div class="collection-field-row">
            <label for="collection-launch" class="collection-field-key">launch</label>
            <div class="collection-field-value">
              <textarea id="collection-launch" placeholder="启动命令"></textarea>
            </div>
          </div>
        </div>
        <div class="edit-actions">
          <div class="left"></div>
          <div class="right">
            <button type="button" id="collection-cancel">取消</button>
            <button type="submit">保存</button>
          </div>
        </div>
      </form>
      <div id="collection-status" class="edit-status"></div>
    </div>
  </div>
  <div id="rominfo-modal" class="modal hidden">
    <div class="modal-content rominfo-content">
      <div class="modal-header">
        <h3>ROM 信息</h3>
        <button type="button" id="rominfo-close">×</button>
      </div>
      <div class="rominfo-body">
        <div class="rominfo-select-row">
          <label for="rominfo-select">选择 ROM 文件</label>
          <select id="rominfo-select" class="rominfo-select"></select>
        </div>
        <div class="rominfo-card rominfo-info">
          <h4>ROM 基础信息</h4>
          <div id="rominfo-files" class="rominfo-list"></div>
        </div>
        <div class="rominfo-panels">
          <div class="rominfo-card scrollable">
            <h4>当前 ROM 信息</h4>
            <div class="rominfo-grid-header rominfo-grid-3">
              <span>文件名</span>
              <span>CRC32</span>
              <span>大小</span>
            </div>
            <div class="rominfo-scroll-body">
              <div id="rominfo-current-subroms" class="rominfo-grid rominfo-grid-3"></div>
            </div>
          </div>
          <div class="rominfo-card scrollable">
            <h4>Dat 子 ROM 状态</h4>
            <div class="rominfo-grid-header rominfo-grid-5">
              <span>文件名</span>
              <span>CRC32</span>
              <span>大小</span>
              <span>状态</span>
              <span>原因</span>
            </div>
            <div class="rominfo-scroll-body">
              <div id="rominfo-subroms" class="rominfo-grid rominfo-grid-5"></div>
            </div>
          </div>
        </div>
        <div id="rominfo-status" class="edit-status"></div>
      </div>
    </div>
  </div>
  <div id="delete-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3>删除游戏</h3>
        <button type="button" id="delete-close">×</button>
      </div>
      <form id="delete-form" class="delete-form">
        <p>确定删除该游戏的元信息？</p>
        <label class="checkbox">
          <input type="checkbox" id="delete-remove-files" />
          <span>同时删除 ROM/媒体文件</span>
        </label>
        <div class="delete-actions">
          <button type="button" id="delete-cancel">取消</button>
          <button type="submit" class="danger">删除</button>
        </div>
      </form>
      <div id="delete-status" class="edit-status"></div>
    </div>
  </div>
  <script src="/static/app.js"></script>
</body>

</html>
